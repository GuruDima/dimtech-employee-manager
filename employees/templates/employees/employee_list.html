{% extends 'base.html' %}
{% load static %}

{% block title %}–°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤{% endblock %}

{% block content %}
<div class="container mt-5 fade-in">
    <!-- üîç –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã -->
    <form method="get" class="row g-3 mb-4">
        <div class="col-md-3">
            <input type="text" name="q" class="form-control" placeholder="üîé –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ —Ñ–∞–º–∏–ª–∏–∏" value="{{ request.GET.q }}">
        </div>
        <div class="col-md-2">
            <select name="position" class="form-select">
                <option value="">–í—Å–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏</option>
                {% for position in positions %}
                    <option value="{{ position }}" {% if request.GET.position == position %}selected{% endif %}>{{ position }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-2">
            <select name="level" class="form-select">
                <option value="">–í—Å–µ —É—Ä–æ–≤–Ω–∏</option>
                {% for code, name in levels %}
                    <option value="{{ code }}" {% if request.GET.level == code %}selected{% endif %}>{{ name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-3">
            <select name="sort" class="form-select">
                <option value="">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</option>
                <option value="name_asc" {% if request.GET.sort == "name_asc" %}selected{% endif %}>–ò–º—è (–ê-–Ø)</option>
                <option value="name_desc" {% if request.GET.sort == "name_desc" %}selected{% endif %}>–ò–º—è (–Ø-–ê)</option>
                <option value="salary_asc" {% if request.GET.sort == "salary_asc" %}selected{% endif %}>–ó–∞—Ä–ø–ª–∞—Ç–∞ ‚Üë</option>
                <option value="salary_desc" {% if request.GET.sort == "salary_desc" %}selected{% endif %}>–ó–∞—Ä–ø–ª–∞—Ç–∞ ‚Üì</option>
                <option value="level_asc" {% if request.GET.sort == "level_asc" %}selected{% endif %}>–£—Ä–æ–≤–µ–Ω—å Jr‚ÜíSr</option>
                <option value="level_desc" {% if request.GET.sort == "level_desc" %}selected{% endif %}>–£—Ä–æ–≤–µ–Ω—å Sr‚ÜíJr</option>
                <option value="date_asc" {% if request.GET.sort == "date_asc" %}selected{% endif %}>–°—Ç–∞—Ä—à–µ –ø–æ –¥–∞—Ç–µ</option>
                <option value="date_desc" {% if request.GET.sort == "date_desc" %}selected{% endif %}>–ù–æ–≤–µ–µ –ø–æ –¥–∞—Ç–µ</option>
            </select>
        </div>
        <div class="col-md-2 d-grid">
            <button type="submit" class="btn btn-outline-primary btn-hover-zoom">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        </div>
    </form>

    {% if employees %}
    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
        {% for employee in employees %}
        <div class="col fade-in">
            <div class="card h-100 shadow-sm border-0 rounded-4 bg-white">
                <div class="card-body">
                    <h5 class="card-title text-primary">{{ employee.first_name }} {{ employee.last_name }}</h5>
                    <p class="card-text"><strong>–î–æ–ª–∂–Ω–æ—Å—Ç—å:</strong> {{ employee.position }}</p>
                    <p class="card-text"><strong>–û–∫–ª–∞–¥:</strong> {{ employee.salary }} ‚Ç∏</p>
                    <p class="card-text"><strong>–£—Ä–æ–≤–µ–Ω—å:</strong> {{ employee.get_level_display }}</p>
                </div>
                <div class="card-footer d-flex justify-content-between bg-transparent border-0">
                    {% if user.is_staff %}
                        <a href="{% url 'employees:employee_update' employee.pk %}" class="btn btn-sm btn-warning btn-hover-zoom">
                            <i class="bi bi-pencil-square"></i> –ò–∑–º–µ–Ω–∏—Ç—å
                        </a>
                        <a href="{% url 'employees:employee_delete' employee.pk %}" class="btn btn-sm btn-danger btn-hover-zoom">
                            <i class="bi bi-trash3"></i> –£–¥–∞–ª–∏—Ç—å
                        </a>
                    {% endif %}
                    <a href="{% url 'employees:employee_detail' employee.pk %}" class="btn btn-sm btn-primary btn-hover-zoom">
                        <i class="bi bi-eye"></i> –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- üìÑ –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
    <nav class="mt-4">
        <ul class="pagination justify-content-center">
            {% if employees.has_previous %}
                <li class="page-item">
                    <a class="page-link" href="?page={{ employees.previous_page_number }}">–ù–∞–∑–∞–¥</a>
                </li>
            {% endif %}
            {% for num in employees.paginator.page_range %}
                {% if employees.number == num %}
                    <li class="page-item active"><span class="page-link">{{ num }}</span></li>
                {% elif num > employees.number|add:'-3' and num < employees.number|add:'3' %}
                    <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
                {% endif %}
            {% endfor %}
            {% if employees.has_next %}
                <li class="page-item">
                    <a class="page-link" href="?page={{ employees.next_page_number }}">–í–ø–µ—Ä—ë–¥</a>
                </li>
            {% endif %}
        </ul>
    </nav>

    {% else %}
        <div class="text-center text-muted fade-in mt-5">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ üò¢</div>
    {% endif %}
</div>
{% endblock %}
